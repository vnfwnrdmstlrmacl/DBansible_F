---
# roles/backup/tasks/db_backup_cron.yml
# 크론도 follow-primary 스크립트를 사용한다.

# main.yml에서 backup_clients에만 import_tasks 하므로 여기서는 assert로 실패시키지 않는다.

- name: Cron - pgBackRest full backup (follow primary)
  ansible.builtin.cron:
    name: "pgBackRest Full Backup (follow primary)"
    minute: "0"
    hour: "1"
    job: "/usr/local/bin/pgbackrest_follow_primary backup --type=full"

- name: Cron - pgBackRest check (follow primary)
  ansible.builtin.cron:
    name: "pgBackRest Check (follow primary)"
    minute: "30"
    hour: "0"
    job: "/usr/local/bin/pgbackrest_follow_primary check"
