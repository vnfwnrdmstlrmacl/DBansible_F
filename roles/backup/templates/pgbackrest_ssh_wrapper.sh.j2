#!/usr/bin/env bash
set -euo pipefail

# Wrapper 목적:
# - pgBackRest가 ssh 실행 시 '--' 또는 '-' 같은 단독 토큰을 끼워 넣는 케이스를 방어
# - CRLF/이상 토큰 정리 후 OpenSSH 실행

SSH_BIN="/usr/bin/ssh"

# 토큰 정리: '--' 또는 '-' 단독 토큰 제거
ARGS=()
for a in "$@"; do
  # CR 제거(혹시 모르니)
  a="${a//$'\r'/}"
  if [[ "$a" == "--" || "$a" == "-" ]]; then
    continue
  fi
  ARGS+=("$a")
done

exec "${SSH_BIN}" "${ARGS[@]}"

