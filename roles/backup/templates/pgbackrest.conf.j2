# Generated by Ansible - pgBackRest configuration

[global]
# repo1-path: 실제 백업 저장 위치 (NFS 마운트 아래 repo1 권장)
repo1-path={{ pgbackrest_repo_path | default(backup_nfs_mount_point ~ '/repo1') }}

# retention (full backups)
repo1-retention-full={{ pgbackrest_retention_full | default(7) }}

start-fast=y
process-max={{ pgbackrest_process_max | default(2) }}
log-level-console={{ pgbackrest_log_level_console | default('info') }}

# ---- stanza ----
[{% set stanza = pgbackrest_stanza | default('main') %}{{ stanza }}]

# ---- PostgreSQL target (primary) ----
{% if pg_primary_host is not defined or (pg_primary_host | string | length) == 0 %}
# ERROR: pg_primary_host is undefined. Define it in group_vars/backup_target.yml (or host_vars/dbb.yml).
{% else %}
pg1-host={{ pg_primary_host }}
{% endif %}

pg1-port={{ pg_primary_port | default(5432) }}
pg1-path={{ pg_primary_data_path | default('/var/lib/pgsql/data') }}
pg1-user={{ pg_backup_db_user | default('postgres') }}

